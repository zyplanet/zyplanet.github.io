<!DOCTYPE html>





<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="apple-touch-icon" sizes="180x180" href="/zyplanet.github.io/images/apple-touch-icon-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/zyplanet.github.io/images/favicon-32x32-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/zyplanet.github.io/images/favicon-16x16-next.png?v=7.3.0">
  <link rel="mask-icon" href="/zyplanet.github.io/images/logo.svg?v=7.3.0" color="#222">

<link rel="stylesheet" href="/zyplanet.github.io/css/main.css?v=7.3.0">


<link rel="stylesheet" href="/zyplanet.github.io/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/zyplanet.github.io/',
    scheme: 'Muse',
    version: '7.3.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    }
  };
</script>

  <meta name="description" content="最优控制理论Introduction最优控制解决的是对某个给定的系统寻找其一个满足特定最优标准的控制规律。它是变分法的一个扩展，也是一种得到控制规律的数值最优方法。这一方法大部分由Lev Pontryagin和Richard Bellman发展，最优控制可以视为控制理论中的一个控制策略。一个控制问题包括一个损失泛函，它是状态变量与控制变量的函数。一个最优控制是描述最小化损失泛函控制变量路径的微分方">
<meta name="keywords" content="Dynamic system">
<meta property="og:type" content="article">
<meta property="og:title" content="optimal control theory">
<meta property="og:url" content="http://yoursite.com/2019/08/27/Optimal Control/index.html">
<meta property="og:site_name" content="Nighttime">
<meta property="og:description" content="最优控制理论Introduction最优控制解决的是对某个给定的系统寻找其一个满足特定最优标准的控制规律。它是变分法的一个扩展，也是一种得到控制规律的数值最优方法。这一方法大部分由Lev Pontryagin和Richard Bellman发展，最优控制可以视为控制理论中的一个控制策略。一个控制问题包括一个损失泛函，它是状态变量与控制变量的函数。一个最优控制是描述最小化损失泛函控制变量路径的微分方">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://i.loli.net/2019/08/27/LSjclJVi2TqyzHC.png">
<meta property="og:image" content="https://i.loli.net/2019/08/27/Icrn2bFQKAeVJay.png">
<meta property="og:updated_time" content="2019-08-28T06:43:45.824Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="optimal control theory">
<meta name="twitter:description" content="最优控制理论Introduction最优控制解决的是对某个给定的系统寻找其一个满足特定最优标准的控制规律。它是变分法的一个扩展，也是一种得到控制规律的数值最优方法。这一方法大部分由Lev Pontryagin和Richard Bellman发展，最优控制可以视为控制理论中的一个控制策略。一个控制问题包括一个损失泛函，它是状态变量与控制变量的函数。一个最优控制是描述最小化损失泛函控制变量路径的微分方">
<meta name="twitter:image" content="https://i.loli.net/2019/08/27/LSjclJVi2TqyzHC.png">
  <link rel="canonical" href="http://yoursite.com/2019/08/27/Optimal Control/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>optimal control theory | Nighttime</title>
  <meta name="generator" content="Hexo 3.9.0">
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/zyplanet.github.io/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Nighttime</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">tell him about nighttime</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/zyplanet.github.io/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/zyplanet.github.io/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
  </ul>

    

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/zyplanet.github.io/2019/08/27/Optimal Control/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zyplanet">
      <meta itemprop="description" content="so I'll be a fleeting sound, a lightray out on the water">
      <meta itemprop="image" content="/zyplanet.github.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nighttime">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">optimal control theory

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2019-08-27 21:28:30" itemprop="dateCreated datePublished" datetime="2019-08-27T21:28:30+08:00">2019-08-27</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-08-28 14:43:45" itemprop="dateModified" datetime="2019-08-28T14:43:45+08:00">2019-08-28</time>
              </span>
            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="最优控制理论"><a href="#最优控制理论" class="headerlink" title="最优控制理论"></a>最优控制理论</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>最优控制解决的是对某个给定的系统寻找其一个满足特定最优标准的控制规律。它是变分法的一个扩展，也是一种得到控制规律的数值最优方法。这一方法大部分由Lev Pontryagin和Richard Bellman发展，最优控制可以视为控制理论中的一个控制策略。一个控制问题包括一个损失泛函，它是状态变量与控制变量的函数。一个最优控制是描述最小化损失泛函控制变量路径的微分方程集合，它可以由Pontryagon极小法则（这是一个必要条件）得到，或者通过求解Hamilton-Jacobi-Bellman方程（充分条件）得到。</p>
<h3 id="控制动力系统"><a href="#控制动力系统" class="headerlink" title="控制动力系统"></a>控制动力系统</h3><p>令$A\subset\mathbb{R}^m$，$\mathbf{f} : \mathbb{R}^{n} \times A \rightarrow \mathbb{R}^{n}$，$\alpha :[0, \infty) \rightarrow A$，考虑如下的动力系统：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{ll}{\dot{\mathbf{x}}(t)=\mathbf{f}(\mathbf{x}(t), \boldsymbol{\alpha}(t))} & {(t>0)} \\ {\mathbf{x}(0)=x^{0}}\end{array}\right.\tag{1.1}</script><p>我们称$\boldsymbol{\alpha} :[0, \infty) \longrightarrow A$为一个控制，对应每个控制的轨迹$\mathbf{x}(\cdot)$为对应系统的响应。</p>
<p>这里定义$\mathcal{A}=\{\boldsymbol{\alpha} :[0, \infty) \rightarrow A | \boldsymbol{\alpha}(\cdot) \text {measurable }\}$为可行控制空间。</p>
<h3 id="损失泛函"><a href="#损失泛函" class="headerlink" title="损失泛函"></a>损失泛函</h3><p>通常来说损失泛函的形式如下：</p>
<script type="math/tex; mode=display">
P[\boldsymbol{\alpha}(\cdot)] :=\int_{0}^{T} r(\mathbf{x}(t), \boldsymbol{\alpha}(t)) d t+g(\mathbf{x}(T))\tag{1.2}</script><p>这里$\mathrm{x}(\cdot)$为$\boldsymbol{\alpha}(\cdot)$下动力系统的解，$r : \mathbb{R}^{n} \times A \rightarrow \mathbb{R}$，$g : \mathbb{R}^{n} \rightarrow \mathbb{R}$为给定的度量。一般称$r$为控制代价，$g$为终止代价，终止点$T&gt;0$也是提前给定的。</p>
<p>基本的问题是，我们想要在$\mathcal{A}$中找到一个能够最小化损失泛函的控制$\alpha^{*}(\cdot)$，这引出了如下的三个问题：</p>
<ol>
<li>最优控制的存在性</li>
<li>怎样刻画这个最优控制</li>
<li>最优控制如何构造</li>
</ol>
<h2 id="可控性与Bang-Bang-原理"><a href="#可控性与Bang-Bang-原理" class="headerlink" title="可控性与Bang-Bang 原理"></a>可控性与Bang-Bang 原理</h2><p>仍然考虑式子$(1.1)$描述的控制动力系统，我们从可控性问题开始。</p>
<h3 id="可控性问题"><a href="#可控性问题" class="headerlink" title="可控性问题"></a>可控性问题</h3><p>给定初始点$x^{0}$以及一个目标集合$S \subset \mathbb{R}^{n}$，是否存在一个控制能够在有限时间内将系统导引至$S$中？首先我们并不给定一个损失泛函以刻画某个最优控制，而是关注是否存在能够将系统导引至给定目标的控制，这里通常假定$S=\{0\}$.</p>
<p>时刻t的可达集$\mathcal{C}(t)$为，由存在控制使得$\mathbf{x}(t)=0$的初值点$x^{0}$构成的集合。</p>
<p>全局可达集$C$为，存在控制及某个有限时间$t$使得$\mathbf{x}(t)=0$的初值点$x^0$构成的集合。</p>
<p>显然有如下关系成立：</p>
<script type="math/tex; mode=display">
\mathcal{C}=\bigcup_{t \geq 0} \mathcal{C}(t)\tag{2.1}</script><h3 id="线性系统的可控性"><a href="#线性系统的可控性" class="headerlink" title="线性系统的可控性"></a>线性系统的可控性</h3><p>很自然地，我们从最简单的一类控制系统开始：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{ll}{\dot{\mathbf{x}}(t)=M \mathbf{x}(t)+N \alpha(t)} & {(t>0)} \\ {\mathbf{x}(0)=x^{0}}\end{array}\right.\tag{2.2}</script><p>这里$M \in \mathbb{M}^{n \times n}$，$N \in \mathbb{M}^{n \times m}$，并限制控制参量的选取仅在一个单位方格中：</p>
<script type="math/tex; mode=display">
A=[-1,1]^{m}=\left\{a \in \mathbb{R}^{m}| | a_{i} | \leq 1, i=1, \ldots, m\right\}\tag{2.3}</script><p>我们可以得到系统$(2.2)$的解析形式解：</p>
<script type="math/tex; mode=display">
\mathbf{x}(t)=\mathbf{X}(t) x^{0}+\mathbf{X}(t) \int_{0}^{t} \mathbf{X}^{-1}(s) N \alpha(s) d s\tag{2.4}</script><p>那么我们可以得到此时$x^{0} \in \mathcal{C}(t)$的等价条件：</p>
<script type="math/tex; mode=display">
x^{0}=-\int_{0}^{t} \mathbf{X}^{-1}(s) N \alpha(s) d s\tag{2.5}</script><p>若存在$\alpha(\cdot) \in \mathcal{A}$使得上式成立。</p>
<p>在线性控制系统中，可达集拥有比较好的性质：</p>
<ul>
<li>可达集$\mathcal{C}$是对称（$\pm x$同时含于可达集中）且凸的</li>
<li>若$x^{0} \in \mathcal{C}(\overline{t})$，则$x^{0} \in \mathcal{C}(t)$对任意$t \geq \overline{t}$成立</li>
</ul>
<p>定义可控性矩阵为：</p>
<script type="math/tex; mode=display">
G=G(M, N) :=\underbrace{\left[N, M N, M^{2} N, \ldots, M^{n-1} N\right]}_{n \times(m n) \text { matrix }}\tag{2.6}</script><p>关于线性系统的可控性，有如下的等价条件：</p>
<script type="math/tex; mode=display">
\operatorname{rank} G=n\Leftrightarrow 0 \in \mathcal{C}^{\circ} \tag{2.7}</script><p>这里概括一下证明思路：1.若控制性矩阵的秩小于n，则零空间非空2.假设$x^0$在t时刻可达集中，利用等价条件$(2.5)$，可证零空间的元素必然正交于$x^0$3.即$C$为控制性矩阵零空间的正交补空间，并且过原点，不存在内点4.相反若原点不是$\mathcal{C}$的内点，由其凸性可知在$\mathcal{C}(t)$中有一个过$0$的支持平面，那么就可以找到其法向量，构造出一个控制性矩阵的非零解。</p>
<p>我们称线性系统可控若$\mathcal{C}=\mathbb{R}^{n}$，有如下的定理：</p>
<p>令$A$为$\mathbb{R}^n$的单位立方体，假定控制性矩阵秩为$n$，并且$M$的所有特征值实部为负，则系统是可控的。</p>
<p>实际上可以对条件进一步减弱，只要$M$的特征值实部非正即可，这里的证明比上面定理复杂很多。</p>
<h3 id="Bang-Bang原理"><a href="#Bang-Bang原理" class="headerlink" title="Bang-Bang原理"></a>Bang-Bang原理</h3><p>这里仍然在单位立方体中选取控制，一个控制$\alpha(\cdot) \in \mathcal{A}$称为bang-bang若对于任意时刻都有$\left|\alpha^{i}(t)\right|=1$成立，可以理解为两状态控制。这是最为简单的一种控制，关于它有如下的定理：</p>
<p>若$x^0\in \mathcal{C}(t)$，则对于线性控制系统$(2.2)$，存在一个bang-bang控制$\alpha(\cdot)$在t时刻将初值引导至原点。</p>
<p>关于它的证明，需要一些泛函分析的知识，这里先省略。</p>
<h2 id="Pontryagin极小条件"><a href="#Pontryagin极小条件" class="headerlink" title="Pontryagin极小条件"></a>Pontryagin极小条件</h2><h3 id="变分法与哈密顿动力系统"><a href="#变分法与哈密顿动力系统" class="headerlink" title="变分法与哈密顿动力系统"></a>变分法与哈密顿动力系统</h3><p>给定一个光滑函数$L : \mathbb{R}^{n} \times \mathbb{R}^{n} \rightarrow \mathbb{R}, L=L(x, v)$，$L$称为拉格朗日算子，这里$T&gt;0, x^{0}, x^{1} \in \mathbb{R}^{n}$都是被给定的。</p>
<p>最开始的变分法考虑的是下面的优化问题：</p>
<script type="math/tex; mode=display">
I[\mathbf{x}(\cdot)] :=\int_{0}^{T} L(\mathbf{x}(t), \dot{\mathbf{x}}(t)) d t\tag{3.1}</script><p>这里$\mathbf{x}(\cdot)$满足$\mathbf{x}(0)=x^{0}$与$\mathbf{x}(T)=x^{1}$，假定$\mathbf{x}^{*}(\cdot)$为$(3.1)$的解，下面考虑如何刻画这个最优解。</p>
<p><strong>欧拉-拉格朗日方程：</strong>若$\mathbf{x}^{*}(\cdot)$为变分问题$(3.1)$的解，那么它满足以下的欧拉-拉格朗日微分方程：</p>
<script type="math/tex; mode=display">
\frac{d}{d t}\left[\nabla_{v} L\left(\mathbf{x}^{*}(t), \dot{\mathbf{x}}^{*}(t)\right)\right]=\nabla_{x} L\left(\mathbf{x}^{*}(t), \dot{\mathbf{x}}^{*}(t)\right)\tag{3.2}</script><p>这给出了一个必要条件，但如果我们能求解$(3.2)$，那么最优解就在这组解中。它的证明很容易查到，这里先省略。</p>
<p>下面我们将EL方程化简为一个一阶ODE，定义广义动量为：</p>
<script type="math/tex; mode=display">
\mathbf{p}(t) :=\nabla_{v} L(\mathbf{x}(t), \dot{\mathbf{x}}(t))\tag{3.3}</script><p>这里总假设我们能从式子$(3.3)$反解出$v$，定义一个动力系统的哈密顿子$H : \mathbb{R}^{n} \times \mathbb{R}^{n} \rightarrow \mathbb{R}$如下：</p>
<script type="math/tex; mode=display">
H(x, p)=p \cdot \mathbf{v}(x, p)-L(x, \mathbf{v}(x, p))\tag{3.4}</script><p>这里$\mathbf{v}$如上定义，有下面的定理：</p>
<p>若$\mathbf{x}(\cdot)$为EL方程的解，那么$(\mathbf{x}(\cdot), \mathbf{p}(\cdot))$满足下面的哈密顿方程：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{l}{\dot{\mathbf{x}}(t)=\nabla_{p} H(\mathbf{x}(t), \mathbf{p}(t))} \\ {\dot{\mathbf{p}}(t)=-\nabla_{x} H(\mathbf{x}(t), \mathbf{p}(t))}\end{array}\right.\tag{3.5}</script><p>进一步，$t \mapsto H(\mathbf{x}(t), \mathbf{p}(t))$必然为常量映射，即满足极小性的、必然遵循某种守恒性。</p>
<h3 id="拉格朗日乘子"><a href="#拉格朗日乘子" class="headerlink" title="拉格朗日乘子"></a>拉格朗日乘子</h3><p>如果定义域没有做任何限制，那么极值点的判别标准即梯度为零，下面考虑有限制的情况。</p>
<p>在$R :=\{x \in \mathbb{R}^{n} | g(x) \leq 0\}$中考虑，令$x^{<em>} \in R$并且有$f(x^</em>)=\max _{x \in R} f(x)$，这里考虑如何刻画这个极值点。</p>
<p>若$\mathrm{x}^<em>$在$R$的内部，那么$\nabla f\left(x^{</em>}\right)=0$.</p>
<p>若$\mathrm{x}^<em>$在$\partial R$上，考虑$\nabla f\left(x^{</em>}\right)$的方向。显然地，如下图所示的情况是不可能的：</p>
<p><img src="https://i.loli.net/2019/08/27/LSjclJVi2TqyzHC.png" alt="impossiblecase"></p>
<p>这表明$\mathrm{x}^*$在沿$\partial R$的方向上仍然存在非零的梯度，即并未达到极值，所以必然是下图所示的情况：</p>
<p><img src="https://i.loli.net/2019/08/27/Icrn2bFQKAeVJay.png" alt="True Case"></p>
<p>即$\nabla f\left(x^{<em>}\right)$必然与$\partial R$某处的法向量共线，这个法向量可以用$\nabla g\left(x^{</em>}\right)$表示，所以有下面的关系成立：</p>
<script type="math/tex; mode=display">
\nabla f\left(x^{*}\right)=\lambda \nabla g\left(x^{*}\right)\tag{3.6}</script><p>由于$\nabla g\left(x^{*}\right)$有可能为零，所以更加准确的描述如下：</p>
<p>存在不同时为零的实数$\lambda$与$\mu$使得：</p>
<script type="math/tex; mode=display">
\mu \nabla f\left(x^{*}\right)=\lambda \nabla g\left(x^{*}\right)\tag{3.7}</script><h3 id="Pontyragin极小原理"><a href="#Pontyragin极小原理" class="headerlink" title="Pontyragin极小原理"></a>Pontyragin极小原理</h3><p>核心的理论结果是，如果$\alpha^{<em>}(\cdot)$为一个最优控制，那么就对应着一个称为costate的函数$\mathbf{p}^{</em>}(\cdot)$，它满足一个特定的极小性，我们应该把costate视作一类拉格朗日乘子。</p>
<h4 id="定时自由终止点问题"><a href="#定时自由终止点问题" class="headerlink" title="定时自由终止点问题"></a>定时自由终止点问题</h4><p>控制理论哈密顿算子如下定义：</p>
<script type="math/tex; mode=display">
H(x, p, a) :=\mathbf{f}(x, a) \cdot p+r(x, a) \qquad\left(x, p \in \mathbb{R}^{n}, a \in A\right)\tag{3.8}</script><p>这里给出pontryagin极小原理的描述：</p>
<p>假定$\alpha^{<em>}(\cdot)$是满足$(1.1)$与给定损失泛函下的最优控制，$\mathrm{x}^{</em>}(\cdot)$是对应的解，那么存在一个函数$\mathrm{p}^{*} :[0, T] \rightarrow \mathbb{R}^{n}$，使得：</p>
<script type="math/tex; mode=display">
\begin{array}{c}{\dot{\mathbf{x}}^{*}(t)=\nabla_{p} H\left(\mathbf{x}^{*}(t), \mathbf{p}^{*}(t), \boldsymbol{\alpha}^{*}(t)\right)} \\ {\dot{\mathbf{p}}^{*}(t)=-\nabla_{x} H\left(\mathbf{x}^{*}(t), \mathbf{p}^{*}(t), \boldsymbol{\alpha}^{*}(t)\right)}\end{array}\tag{3.9}</script><p>并且此时：</p>
<script type="math/tex; mode=display">
H\left(\mathbf{x}^{*}(t), \mathbf{p}^{*}(t), \boldsymbol{\alpha}^{*}(t)\right)=\max _{a \in A} H\left(\mathbf{x}^{*}(t), \mathbf{p}^{*}(t), a\right) \qquad(0 \leq t \leq T)\tag{3.10}</script><p>进一步有$t \mapsto H\left(\mathbf{x}^{<em>}(t), \mathbf{p}^{</em>}(t), \boldsymbol{\alpha}^{*}(t)\right)$为常值映射，以及终止条件：</p>
<script type="math/tex; mode=display">
\mathbf{p}^{*}(T)=\nabla g\left(\mathbf{x}^{*}(T)\right)\tag{3.11}</script><p>这里$(3.9)$的第二个式子是伴随方程，$(3.10)$是极小（极大）原理。也称$(3.11)$为截断条件，在之后会进一步讨论。</p>
<p>更加详细地，$(3.9)$的第一个式子为：</p>
<script type="math/tex; mode=display">
\dot{x}^{i *}(t)=H_{p_{i}}\left(\mathbf{x}^{*}(t), \mathbf{p}^{*}(t), \boldsymbol{\alpha}^{*}(t)\right)=f^{i}\left(\mathbf{x}^{*}(t), \boldsymbol{\alpha}^{*}(t)\right)\tag{3.12}</script><p>这正是原始的控制系统方程。</p>
<p>伴随方程则为：</p>
<script type="math/tex; mode=display">
\begin{aligned} \dot{p}^{i *}(t) &=-H_{x_{i}}\left(\mathrm{x}^{*}(t), \mathbf{p}^{*}(t), \boldsymbol{\alpha}^{*}(t)\right) \\ &=-\sum_{j=1}^{n} p^{j *}(t) f_{x_{i}}^{j}\left(\mathrm{x}^{*}(t), \boldsymbol{\alpha}^{*}(t)\right)-r_{x_{i}}\left(\mathrm{x}^{*}(t), \alpha^{*}(t)\right) \end{aligned}\tag{3.13}</script><p>在深度学习中，大多都是定时自由终点问题，另一种情况（定终点自由时间问题）这里省略。</p>
<h3 id="应用极小原理"><a href="#应用极小原理" class="headerlink" title="应用极小原理"></a>应用极小原理</h3><p>对于控制问题，直接寻找一个最优控制$\boldsymbol{\alpha}^{<em>}(\cdot)$以及对应的解$\mathrm{x}^{</em>}(\cdot)$并不那么容易，我们可以通过求解$\mathbf{p}^{*}(\cdot)$来简化这个问题。这里以一个实际的例子来阐述这个过程：</p>
<p>构造一个简单的经济模型，以$x(t)$表示$t$时刻经济产量，$\alpha(t)$表示$t$时刻将产量再投资的比例，经济模型以如下的形式演化：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{l}{\dot{x}(t)=\alpha(t) x(t) \quad(0 \leq t \leq T)} \\ {x(0)=x^{0}}\end{array}\right.\tag{3.14}</script><p>我们希望极大化总消费量：</p>
<script type="math/tex; mode=display">
P[\alpha(\cdot)] :=\int_{0}^{T}(1-\alpha(t)) x(t) d t\tag{3.15}</script><p>使用pontryagin极小原理，有：</p>
<script type="math/tex; mode=display">
f(x, a)=x a, g \equiv 0, r(x, a)=(1-a) x\tag{3.16}</script><p>因此有：</p>
<script type="math/tex; mode=display">
H(x, p, a)=f(x, a) p+r(x, a)=p x a+(1-a) x=x+a x(p-1)\tag{3.17}</script><p>带入$(3.9)$有：</p>
<script type="math/tex; mode=display">
\begin{array}\dot{x}(t)=H_{p}=\alpha(t) x(t)\\
\dot{p}(t)=-H_{x}=-1-\alpha(t)(p(t)-1)\end{array}\tag{3.18}</script><p>终止条件为：</p>
<script type="math/tex; mode=display">
p(T)=g_{x}(x(T))=0\tag{3.19}</script><p>最后，极大原理有：</p>
<script type="math/tex; mode=display">
H(x(t), p(t), \alpha(t))=\max _{0 \leq a \leq 1}\{x(t)+a x(t)(p(t)-1)\}\tag{3.20}</script><p>下面开始求解，根据$(3.20)$有（$x(t)&gt;0$）：</p>
<script type="math/tex; mode=display">
\alpha(t)=\left\{\begin{array}{lll}{1} & {\text { if }} & {p(t)>1} \\ {0} & {\text { if }} & {p(t) \leq 1}\end{array}\right.\tag{3.21}</script><p>下一步需要确定$p(\cdot)$，由$(3.18)$及$(3.19)$有：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{l}{\dot{p}(t)=-1-\alpha(t)[p(t)-1] \qquad(0 \leq t \leq T)} \\ {p(T)=0}\end{array}\right.\tag{3.22}</script><p>下面分情况讨论，若$p(t)\le1$，则$\alpha(t)=0$，因此$\dot{p}(t)=-1$，那么有$p(t)=T-t$，而这在满足假设的条件下成立，即$T-1 \leq t \leq T$时刻。</p>
<p>令一种情况，若$p(t)&gt;1$，则$\alpha(t)=1$，有：</p>
<script type="math/tex; mode=display">
\dot{p}(t)=-1-(p(t)-1)=-p(t)\tag{3.23}</script><p>又由连续性，$p(T-1)=1$，故而$p(t)=e^{T-1-t}$，又需满足假设，可知这在$0 \leq t \leq T-1$上成立。</p>
<p>综上所述，最优控制为：</p>
<script type="math/tex; mode=display">
\alpha^{*}(t)=\left\{\begin{array}{ll}{1} & {\text { if } \quad 0 \leq t \leq t^{*}} \\ {0} & {\text { if } \quad t^{*} \leq t \leq T}\end{array}\right.\tag{3.24}</script><p>$t^{*}=T-1$.</p>
<h2 id="动态规划"><a href="#动态规划" class="headerlink" title="动态规划"></a>动态规划</h2><h3 id="Bellman方程"><a href="#Bellman方程" class="headerlink" title="Bellman方程"></a>Bellman方程</h3><p>考虑下面更一般的动力系统：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{l}{\dot{\mathbf{x}}(s)=\mathbf{f}(\mathbf{x}(s), \boldsymbol{\alpha}(s)) \quad(t \leq s \leq T)} \\ {\mathbf{x}(t)=x}\end{array}\right.\tag{4.1}</script><p>以及对应的损失泛函：</p>
<script type="math/tex; mode=display">
P_{x, t}[\boldsymbol{\alpha}(\cdot)]=\int_{t}^{T} r(\mathbf{x}(s), \boldsymbol{\alpha}(s)) d s+g(\mathbf{x}(T))\tag{4.2}</script><p>给定$x \in \mathbb{R}^{n}, 0 \leq t \leq T$，定义价值函数$v(x, t)$为：</p>
<script type="math/tex; mode=display">
v(x, t) :=\sup _{\boldsymbol{\alpha}(\cdot) \in \mathcal{A}} P_{x, t}[\boldsymbol{\alpha}(\cdot)] \qquad\left(x \in \mathbb{R}^{n}, 0 \leq t \leq T\right)\tag{4.3}</script><p>价值函数给出了$x,t$的泛函.</p>
<p>Hamilton-Jacobi-Bellman方程刻画了价值函数，假定价值函数为$(x,t)$的$C^1$函数，则$v$满足如下的方程：</p>
<script type="math/tex; mode=display">
\begin{array}
vv_{t}(x, t)+\max _{a \in A}\left\{\mathbf{f}(x, a) \cdot \nabla_{x} v(x, t)+r(x, a)\right\}=0 \qquad\left(x \in \mathbb{R}^{n}, 0 \leq t<T\right)\\
v(x, T)=g(x) \qquad\left(x \in \mathbb{R}^{n}\right)\end{array}\tag{4.4}</script><p>我们可以将HJB写作：</p>
<script type="math/tex; mode=display">
v_{t}(x, t)+H\left(x, \nabla_{x} v\right)=0 \qquad\left(x \in \mathbb{R}^{n}, 0 \leq t<T\right)\tag{4.5}</script><p>这里的哈密顿子定义为：</p>
<script type="math/tex; mode=display">
H(x, p) :=\max _{a \in A} H(x, p, a)=\max _{a \in A}\{\mathbf{f}(x, a) \cdot p+r(x, a)\}\tag{4.6}</script><p>关于HJB方程的证明比较长，这里省略。</p>
<p>动态规划方法可以描述如下：</p>
<p>1.求解HJB方程，得到价值函数$v$</p>
<p>2.利用$v$来选取控制$\boldsymbol{\alpha}(x, t)$，这里$\boldsymbol{\alpha}(x, t)$满足：</p>
<script type="math/tex; mode=display">
v_{t}(x, t)+\mathbf{f}(x, \boldsymbol{\alpha}(x, t)) \cdot \nabla_{x} v(x, t)+r(x, \boldsymbol{\alpha}(x, t))=0\tag{4.5}</script><p>3.求解如下的ODE，假定$\boldsymbol{\alpha}(\cdot, t)$拥有比较好的性质：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{ll}{\dot{\mathbf{x}}^{*}(s)=} & {\mathbf{f}\left(\mathbf{x}^{*}(s), \boldsymbol{\alpha}\left(\mathbf{x}^{*}(s), s\right)\right) \quad(t \leq s \leq T)} \\ {\mathbf{x}(t)=x}\end{array}\right.\tag{4.6}</script><p>4.定义反馈控制为：</p>
<script type="math/tex; mode=display">
\alpha^{*}(s) :=\alpha\left(\mathrm{x}^{*}(s), s\right)\tag{4.7}</script><p>总的来说，我们以这样的方式来设计最优控制：若系统的状态为$(x,t)$，我们使用在t时刻是的HJB的极小被满足的$a \in A$.</p>
<p>可以证明，反馈控制即为一个最优控制，证明并不复杂。</p>
<p>由$(4.7)$的定义以及式子$(4.5)$，有：</p>
<script type="math/tex; mode=display">
\begin{aligned} P_{x, t}\left[\boldsymbol{\alpha}^{*}(\cdot)\right] &=\int_{t}^{T}\left(-v_{t}\left(\mathbf{x}^{*}(s), s\right)-\mathbf{f}\left(\mathbf{x}^{*}(s), \boldsymbol{\alpha}^{*}(s)\right) \cdot \nabla_{x} v\left(\mathbf{x}^{*}(s), s\right)\right) d s+g\left(\mathbf{x}^{*}(T)\right) \\ &=-\int_{t}^{T} v_{t}\left(\mathbf{x}^{*}(s), s\right)+\nabla_{x} v\left(\mathbf{x}^{*}(s), s\right) \cdot \dot{\mathbf{x}}^{*}(s) d s+g\left(\mathbf{x}^{*}(T)\right) \\ &=-\int_{t}^{T} \frac{d}{d s} v\left(\mathbf{x}^{*}(s), s\right) d s+g\left(\mathbf{x}^{*}(T)\right) \\ &=-v\left(\mathbf{x}^{*}(T), T\right)+v\left(\mathbf{x}^{*}(t), t\right)+g\left(\mathbf{x}^{*}(T)\right) \\ &=-g\left(\mathbf{x}^{*}(T)\right)+v\left(\mathbf{x}^{*}(t), t\right)+g\left(\mathbf{x}^{*}(T)\right) \\ &=v(x, t)=\sup _{\boldsymbol{\alpha}(\cdot) \in \mathcal{A}} P_{x, t}[\boldsymbol{\alpha}(\cdot)] \end{aligned}</script><p>故而$\boldsymbol{\alpha}^{*}(\cdot)$是最优的. </p>
<p>我们以一个简单的例子来进一步阐述这个流程，</p>
<p>运输车以以下的方程运动，</p>
<script type="math/tex; mode=display">
\left(\begin{array}{c}{\dot{x}_{1}} \\ {\dot{x}_{2}}\end{array}\right)=\left(\begin{array}{ll}{0} & {1} \\ {0} & {0}\end{array}\right)\left(\begin{array}{c}{x_{1}} \\ {x_{2}}\end{array}\right)+\left(\begin{array}{c}{0} \\ {1}\end{array}\right) \alpha, \quad|\alpha| \leq 1</script><p>损失泛函为，</p>
<script type="math/tex; mode=display">
P[\alpha(\cdot)]=-\text { time to reach }(0,0)=-\int_{0}^{\tau} 1 d t=-\tau</script><p>要使用动态规划，我们定义$v(x_1,x_2)$为负最小到达原点时间，起始点被定为$(x_1,x_2)$.</p>
<p>优于$v$并不依赖于$t$，所以有：</p>
<script type="math/tex; mode=display">
\max _{a \in A}\left\{\mathbf{f} \cdot \nabla_{x} v+r\right\}=0</script><p>并且，</p>
<script type="math/tex; mode=display">
A=[-1,1], \quad \mathrm{f}=\left(\begin{array}{c}{x_{2}} \\ {a}\end{array}\right), \quad r=-1</script><p>那么有，</p>
<script type="math/tex; mode=display">
\max _{|a| \leq 1}\left\{x_{2} v_{x_{1}}+a v_{x_{2}}-1\right\}=0</script><p>可得方程为：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{ll}{x_{2} v_{x_{1}}+\left|v_{x_{2}}\right|-1=0} & {\text { in } \mathbb{R}^{2}} \\ {v(0,0)=0}\end{array}\right.</script><p>下面检查方程是否满足，定义两个区域：</p>
<script type="math/tex; mode=display">
I :=\left\{\left(x_{1}, x_{2}\right)|x_{1} \geq-\frac{1}{2} x_{2}| x_{2} |\right\} \quad \text { and } \quad I I :=\left\{\left(x_{1}, x_{2}\right)|x_{1} \leq-\frac{1}{2} x_{2}| x_{2} |\right\}</script><p>直接计算得：</p>
<script type="math/tex; mode=display">
v(x)=\left\{\begin{array}{ll}{-x_{2}-2\left(x_{1}+\frac{1}{2} x_{2}^{2}\right)^{\frac{1}{2}}} & {\text { in Region I }} \\ {x_{2}-2\left(-x_{1}+\frac{1}{2} x_{2}^{2}\right)^{\frac{1}{2}}} & {\text { in Region II. }}\end{array}\right.</script><p>在区域$I$计算可得：</p>
<script type="math/tex; mode=display">
\begin{array}{l}{v_{x_{2}}=-1-\left(x_{1}+\frac{x_{2}^{2}}{2}\right)^{-\frac{1}{2}} x_{2}} \\ {v_{x_{1}}=-\left(x_{1}+\frac{x_{2}^{2}}{2}\right)^{-\frac{1}{2}}}\end{array}</script><p>因此：</p>
<script type="math/tex; mode=display">
x_{2} v_{x_{1}}+\left|v_{x_{2}}\right|-1=-x_{2}\left(x_{1}+\frac{x_{2}^{2}}{2}\right)^{-\frac{1}{2}}+\left[1+x_{2}\left(x_{1}+\frac{x_{2}^{2}}{2}\right)^{-\frac{1}{2}}\right]-1=0</script><p>这表明了HJB在区域$I$是满足的，同样也可在区域$II$上得到验证。</p>
<p>由于$\max _{|a| \leq 1}\left\{x_{2} v_{x_{1}}+a v_{x_{2}}+1\right\}=0$，所以可知最优控制为：</p>
<script type="math/tex; mode=display">
\alpha=\operatorname{sgn} v_{x_{2}}</script><h3 id="动态规划与Pontryagin极小原理"><a href="#动态规划与Pontryagin极小原理" class="headerlink" title="动态规划与Pontryagin极小原理"></a>动态规划与Pontryagin极小原理</h3><h4 id="特征方法"><a href="#特征方法" class="headerlink" title="特征方法"></a>特征方法</h4><p>假定$H : \mathbb{R}^{n} \times \mathbb{R}^{n} \rightarrow \mathbb{R}$并考虑如下的Hamilton-Jacobi方程初值问题</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{l}{u_{t}(x, t)+H\left(x, \nabla_{x} u(x, t)\right)=0 \qquad\left(x \in \mathbb{R}^{n}, 0<t<T\right)} \\ {u(x, 0)=g(x)}\end{array}\right.\tag{4.8}</script><p>做以下的记号：</p>
<script type="math/tex; mode=display">
\mathbf{x}(t)=\left(\begin{array}{c}{x^{1}(t)} \\ {\vdots} \\ {x^{n}(t)}\end{array}\right), \mathbf{p}(t)=\nabla_{x} u(\mathbf{x}(t), t)=\left(\begin{array}{c}{p^{1}(t)} \\ {\vdots} \\ {p^{n}(t)}\end{array}\right)\tag{4.9}</script><p>下面引出特征方程，有：</p>
<script type="math/tex; mode=display">
p^{k}(t)=u_{x_{k}}(\mathbf{x}(t), t)\tag{4.10}</script><p>因此</p>
<script type="math/tex; mode=display">
\dot{p}^{k}(t)=u_{x_{k} t}(\mathbf{x}(t), t)+\sum_{i=1}^{n} u_{x_{k} x_{i}}(\mathbf{x}(t), t) \cdot \dot{x}^{i}\tag{4.11}</script><p>假定$u$为式子$(4.8)$的解，我们两边对$x_k$求导：</p>
<script type="math/tex; mode=display">
u_{t x_{k}}(x, t)=-H_{x_{k}}(x, \nabla u(x, t))-\sum_{i=1}^{n} H_{p_{i}}(x, \nabla u(x, t)) \cdot u_{x_{k} x_{i}}(x, t)\tag{4.12}</script><p>代入式子$(4.11)$中：</p>
<script type="math/tex; mode=display">
\dot{p}^{k}(t)=-H_{x_{k}}(\mathbf{x}(t), \underbrace{\nabla_{x} u(\mathbf{x}(t), t)}_{\mathbf{p}(t)})+\sum_{i=1}^{n}(\dot{x}^{i}(t)-H_{p_{i}}(\mathbf{x}(t), \underbrace{\nabla_{x} u(x, t)}_{\mathbf{p}(t)}) u_{x_{k} x_{i}}(\mathbf{x}(t), t).\tag{4.13}</script><p>如果我们选取$\mathbf{x}(\cdot)$使得：</p>
<script type="math/tex; mode=display">
\dot{x}^{i}(t)=H_{p_{i}}(\mathrm{x}(t), \mathbf{p}(t)), \qquad(1 \leq i \leq n)\tag{4.14}</script><p>那么$(4.13)$成为：</p>
<script type="math/tex; mode=display">
\dot{p}^{k}(t)=-H_{x_{k}}(\mathbf{x}(t), \mathbf{p}(t)), \qquad(1 \leq k \leq n)\tag{4.15}</script><p>这正是哈密顿方程：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{l}{\dot{\mathbf{x}}(t)=\nabla_{p} H(\mathbf{x}(t), \mathbf{p}(t))} \\ {\dot{\mathbf{p}}(t)=-\nabla_{x} H(\mathbf{x}(t), \mathbf{p}(t))}\end{array}\right.\tag{4.16}</script><p>接下来想要说明的是，如果我们能求解$(4.16)$，那么$(4.8)$也被相应求解。</p>
<script type="math/tex; mode=display">
\begin{aligned} \frac{d}{d t} u(\mathbf{x}(t), t) &=u_{t}(\mathbf{x}(t), t)+\nabla_{x} u(\mathbf{x}(t), t) \cdot \dot{\mathbf{x}}(t) \\ &=-H(\underbrace{\nabla_{x} u(\mathbf{x}(t), t)}_{\mathbf{p}(t)}, \mathbf{x}(t))+\underbrace{\nabla_{x} u(\mathbf{x}(t), t)}_{\mathbf{p}(t)} \cdot \nabla_{p} H(\mathbf{x}(t), \mathbf{p}(t)) \\ &=-H(\mathbf{x}(t), \mathbf{p}(t))+\mathbf{p}(t) \cdot \nabla_{p} H(\mathbf{x}(t), \mathbf{p}(t)) \end{aligned}</script><p>并且有$u(\mathbf{x}(0), 0)=u\left(x^{0}, 0\right)=g\left(x^{0}\right)$，积分可得：</p>
<script type="math/tex; mode=display">
u(\mathbf{x}(t), t)=\int_{0}^{t}-H+\nabla_{p} H \cdot \mathbf{p} d s+g\left(x^{0}\right)\tag{4.17}</script><p>这即是$(4.8)$的解，只要$\mathbf{x}(\cdot)$与$\mathbf{p}(\cdot)$被求解出来。</p>
<h4 id="动态规划与Pontryagin极小原理的联系"><a href="#动态规划与Pontryagin极小原理的联系" class="headerlink" title="动态规划与Pontryagin极小原理的联系"></a>动态规划与Pontryagin极小原理的联系</h4><p>回忆式子$(4.1)$描述的更一般的动力系统，以及所定义的价值函数。这里主要的结果是，Pontryagin极小原理中的costate函数，实际上是价值函数$v$对$x$的梯度：</p>
<p>假定$\alpha^{<em>}(\cdot), x^{</em>}(\cdot)$为方程与损失泛函的最优控制和最优解，如果价值函数$v$为$C^2$的则极小原理中的costate$\mathbf{p}^{*}(\cdot)$满足以下的方程：</p>
<script type="math/tex; mode=display">
\mathbf{p}^{*}(s)=\nabla_{x} v\left(\mathbf{x}^{*}(s), s\right) \qquad(t \leq s \leq T)\tag{4.18}</script><p>其证明较长，这里省略。</p>
<h2 id="微分博弈"><a href="#微分博弈" class="headerlink" title="微分博弈"></a>微分博弈</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>在深度学习中，博弈存在于GAN为代表的这类生成模型中，这在控制理论中也有对应的理论。这一节中讨论双人零和博弈（这正是GAN使用的）。基本的想法是，两个玩家分别控制两个动力系统，其中一个需要达到某种极大，另一个达到某种极小，并也存在着一个损失泛函。</p>
<p>对于两者最好的策略是什么？显然双方的行为不可能独立，任何一方的控制都会取决于另一方当前的状态。</p>
<p>我们对这个双控制的动力系统作出如下的定义：</p>
<p>给定$0 \leq t&lt;T$，以及两个集合$A \subseteq \mathbb{R}^{m}$，$B \subseteq \mathbb{R}^{l}$与函数$\mathrm{f} : \mathbb{R}^{n} \times A \times B \rightarrow \mathbb{R}^{n}$. 定义玩家一的控制为$\boldsymbol{\alpha}(\cdot) :[t, T] \rightarrow A$，玩家二的控制为$\boldsymbol{\beta}(\cdot) :[t, T] \rightarrow B$，最终的动力系统形式如下：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{l}{\dot{\mathbf{x}}(s)=\mathbf{f}(\mathbf{x}(s), \boldsymbol{\alpha}(s), \boldsymbol{\beta}(s)) \qquad(t \leq s \leq T)} \\ {\mathbf{x}(t)=x}\end{array}\right.\tag{5.1}</script><p>初始点$x \in \mathbb{R}^{n}$是被给定的。</p>
<p>博弈的损失泛函如下定义：</p>
<script type="math/tex; mode=display">
P_{x, t}[\boldsymbol{\alpha}(\cdot), \boldsymbol{\beta}(\cdot)] :=\int_{t}^{T} r(\mathbf{x}(s), \boldsymbol{\alpha}(s), \boldsymbol{\beta}(s)) d s+g(\mathbf{x}(T))\tag{5.2}</script><p>在博弈中，玩家一需要选取$\alpha(\cdot)$极大化$(5.2)$，玩家二则选取$\boldsymbol{\beta}(\cdot)$极小化$(5.2)$. 这就是我们所说的二人零和微分博弈，这里使用动态规划来研究这个问题。</p>
<p>映射$\Phi : B(t) \rightarrow A(t)$称为玩家一的策略若在任何$t \leq s \leq T$中，</p>
<script type="math/tex; mode=display">
\boldsymbol{\beta}(\tau) \equiv \hat{\boldsymbol{\beta}}(\tau) \quad \text { for } t \leq \tau \leq s\Rightarrow\Phi[\boldsymbol{\beta}](\tau) \equiv \Phi[\hat{\boldsymbol{\beta}}](\tau) \quad \text { for } t \leq \tau \leq s\tag{5.3}</script><p>我们可以认为$\Phi[\boldsymbol{\beta}]$是玩家一对玩家二所制定策略的响应，并且条件$(5.3)$表明了玩家一并不能得到未来状态的信息。</p>
<p>玩家二的策略为映射$\Psi : A(t) \rightarrow B(t)$，若对于任何$t \leq s \leq T$，</p>
<script type="math/tex; mode=display">
\boldsymbol{\alpha}(\tau) \equiv \hat{\boldsymbol{\alpha}}(\tau) \quad \text { for } t \leq \tau \leq s\Rightarrow \Psi[\boldsymbol{\alpha}](\tau) \equiv \Psi[\hat{\boldsymbol{\alpha}}](\tau) \quad \text { for } t \leq \tau \leq s\tag{5.4}</script><p>并定义策略集合：</p>
<script type="math/tex; mode=display">
\begin{array}{l}{\mathcal{A}(t) :=\text { strategies for player } I \text { (starting at } t )} \\ {\mathcal{B}(t) :=\text { strategies for player } I I \text { (starting at } t )}\end{array}</script><p>接下来引入如下的价值函数，</p>
<p>下价值函数为：</p>
<script type="math/tex; mode=display">
v(x, t) :=\inf _{\Psi \in \mathcal{B}(t)} \sup _{\boldsymbol{\alpha}(\cdot) \in A(t)} P_{x, t}[\boldsymbol{\alpha}(\cdot), \Psi[\boldsymbol{\alpha}](\cdot)]\tag{5.5}</script><p>上价值函数为：</p>
<script type="math/tex; mode=display">
u(x, t) :=\sup _{\Phi \in \mathcal{A}(t)} \inf _{\boldsymbol{\beta}(\cdot) \in B(t)} P_{x, t}[\Phi[\boldsymbol{\beta}](\cdot), \boldsymbol{\beta}(\cdot)]\tag{5.6}</script><p>一个玩家宣布他的策略，即他对另一玩家策略的响应，然后由另一个玩家来选取控制。选取策略的玩家更有优势，即总有下面的关系成立：</p>
<script type="math/tex; mode=display">
v(x, t) \leq u(x, t)\tag{5.7}</script><h3 id="动态规划与Isaacs方程"><a href="#动态规划与Isaacs方程" class="headerlink" title="动态规划与Isaacs方程"></a>动态规划与Isaacs方程</h3><p>假定$u,v$都是$C^1$的，那么$u$满足上Isaacs方程：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{l}{u_{t}+\min _{b \in B} \max _{a \in A}\left\{\mathbf{f}(x, a, b) \cdot \nabla_{x} u(x, t)+r(x, a, b)\right\}=0} \\ {u(x, T)=g(x)}\end{array}\right.\tag{5.8}</script><p>$v$满足下Isaacs方程：</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{l}{v_{t}+\max _{a \in A} \min _{b \in B}\left\{\mathbf{f}(x, a, b) \cdot \nabla_{x} v(x, t)+r(x, a, b)\right\}=0} \\ {v(x, T)=g(x)}\end{array}\right.\tag{5.9}</script><p>Isaacs方程实际上是HJB在双人零和博弈上的推广，同样我们可以对其进行如下改写：</p>
<script type="math/tex; mode=display">
u_{t}+H^{+}\left(x, \nabla_{x} u\right)=0\tag{5.10}</script><p>这里上哈密顿子定义为：</p>
<script type="math/tex; mode=display">
H^{+}(x, p) :=\min _{b \in B} \max _{a \in A}\{\mathbf{f}(x, a, b) \cdot p+r(x, a, b)\}\tag{5.11}</script><p>以及，</p>
<script type="math/tex; mode=display">
v_{t}+H^{-}\left(x, \nabla_{x} v\right)=0\tag{5.12}</script><script type="math/tex; mode=display">
H^{-}(x, p) :=\max _{a \in A} \min _{b \in B}\{\mathbf{f}(x, a, b) \cdot p+r(x, a, b)\}\tag{5.13}</script><p>当博弈到达均衡时，就是我们所要求解的最优点，即有：</p>
<script type="math/tex; mode=display">
\max _{a \in A} \min _{b \in B}\{\mathbf{f}(\cdots) \cdot p+r(\cdots)\}=\min _{b \in B} \max _{a \in A}\{\mathbf{f}(\cdots) \cdot p+r(\cdots)\}\tag{5.14}</script><p>这时$u\equiv v$，更加直接地，一个均衡状态可以如下描述：</p>
<script type="math/tex; mode=display">
P_{x, t}\left[\boldsymbol{\alpha}(\cdot), \boldsymbol{\beta}^{*}(\cdot)\right] \leq P_{x, t}\left[\boldsymbol{\alpha}^{*}(\cdot), \boldsymbol{\beta}^{*}(\cdot)\right] \leq P_{x, t}\left[\boldsymbol{\alpha}^{*}(\cdot), \boldsymbol{\beta}(\cdot)\right]\tag{5.15}</script><p>即双方任何一方进行控制的变动，都不会使得自己得到更好的结果。</p>
<h3 id="Prontryagin极小原理与博弈"><a href="#Prontryagin极小原理与博弈" class="headerlink" title="Prontryagin极小原理与博弈"></a>Prontryagin极小原理与博弈</h3><p>假定均衡条件$(5.14)$满足，并且得到了最优的$\alpha^{<em>}(\cdot), \beta^{</em>}(\cdot)$. 令$\mathbf{x}^{*}(\cdot)$为对应动力系统的解，定义：</p>
<script type="math/tex; mode=display">
\mathbf{p}^{*}(t) :=\nabla_{x} v\left(\mathbf{x}^{*}(t), t\right)=\nabla_{x} u\left(\mathbf{x}^{*}(t), t\right)\tag{5.16}</script><p>那么有以下的伴随方程：</p>
<script type="math/tex; mode=display">
\dot{\mathbf{p}}^{*}(t)=-\nabla_{x} H\left(\mathbf{x}^{*}(t), \mathbf{p}^{*}(t), \boldsymbol{\alpha}^{*}(t), \boldsymbol{\beta}^{*}(t)\right)\tag{5.17}</script><p>其中有博弈论哈密顿算子：</p>
<script type="math/tex; mode=display">
H(x, p, a, b) :=\mathbf{f}(x, a, b) \cdot p+r(x, a, b)\tag{5.18}</script>
    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/zyplanet.github.io/tags/Dynamic-system/" rel="tag"># Dynamic system</a>
            
          </div>
        

        

      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc" data-target="post-toc-wrap">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview" data-target="site-overview-wrap">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#最优控制理论"><span class="nav-number">1.</span> <span class="nav-text">最优控制理论</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Introduction"><span class="nav-number">1.1.</span> <span class="nav-text">Introduction</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#控制动力系统"><span class="nav-number">1.1.1.</span> <span class="nav-text">控制动力系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#损失泛函"><span class="nav-number">1.1.2.</span> <span class="nav-text">损失泛函</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#可控性与Bang-Bang-原理"><span class="nav-number">1.2.</span> <span class="nav-text">可控性与Bang-Bang 原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#可控性问题"><span class="nav-number">1.2.1.</span> <span class="nav-text">可控性问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#线性系统的可控性"><span class="nav-number">1.2.2.</span> <span class="nav-text">线性系统的可控性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bang-Bang原理"><span class="nav-number">1.2.3.</span> <span class="nav-text">Bang-Bang原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pontryagin极小条件"><span class="nav-number">1.3.</span> <span class="nav-text">Pontryagin极小条件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#变分法与哈密顿动力系统"><span class="nav-number">1.3.1.</span> <span class="nav-text">变分法与哈密顿动力系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#拉格朗日乘子"><span class="nav-number">1.3.2.</span> <span class="nav-text">拉格朗日乘子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pontyragin极小原理"><span class="nav-number">1.3.3.</span> <span class="nav-text">Pontyragin极小原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#定时自由终止点问题"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">定时自由终止点问题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#应用极小原理"><span class="nav-number">1.3.4.</span> <span class="nav-text">应用极小原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#动态规划"><span class="nav-number">1.4.</span> <span class="nav-text">动态规划</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Bellman方程"><span class="nav-number">1.4.1.</span> <span class="nav-text">Bellman方程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动态规划与Pontryagin极小原理"><span class="nav-number">1.4.2.</span> <span class="nav-text">动态规划与Pontryagin极小原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#特征方法"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">特征方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#动态规划与Pontryagin极小原理的联系"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">动态规划与Pontryagin极小原理的联系</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#微分博弈"><span class="nav-number">1.5.</span> <span class="nav-text">微分博弈</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#定义"><span class="nav-number">1.5.1.</span> <span class="nav-text">定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动态规划与Isaacs方程"><span class="nav-number">1.5.2.</span> <span class="nav-text">动态规划与Isaacs方程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Prontryagin极小原理与博弈"><span class="nav-number">1.5.3.</span> <span class="nav-text">Prontryagin极小原理与博弈</span></a></li></ol></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">zyplanet</p>
  <div class="site-description" itemprop="description">so I'll be a fleeting sound, a lightray out on the water</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/zyplanet.github.io/archives/">
        
          <span class="site-state-item-count">1</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
        
        
          
        
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span>
        
      </div>
    
  </nav>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zyplanet</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.3.0</div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/zyplanet.github.io/lib/jquery/index.js?v=3.4.1"></script>
  <script src="/zyplanet.github.io/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/zyplanet.github.io/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/zyplanet.github.io/js/utils.js?v=7.3.0"></script><script src="/zyplanet.github.io/js/motion.js?v=7.3.0"></script>
<script src="/zyplanet.github.io/js/schemes/muse.js?v=7.3.0"></script>
<script src="/zyplanet.github.io/js/next-boot.js?v=7.3.0"></script>



  





















  

  
    
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    
  

  

  

</body>
</html>
